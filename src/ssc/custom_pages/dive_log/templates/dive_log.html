<p>
  my dive log, parsed from uddf exported from
  <a href="https://subsurface-divelog.org/">subsurface</a>
</p>

<div class="dive-accordion">
  {# sort by divenumber (dict key) descending #} {% for dn, d in
  dives|dictsort(reverse=True) %}
  <details class="dive">
    <summary>
      <span class="num">#{{ dn }}</span>
      <span class="date">
        {% if d.datetime %}<time datetime="{{ d.datetime.isoformat() }}">
          {{ d.datetime.strftime("%Y-%m-%d") }} </time
        >{% endif %}
      </span>
      <span class="time"
        >{% if d.datetime %}{{ d.datetime.strftime("%H:%M") }}{% endif %}</span
      >
      <span class="depth">
        {% if d.greatestdepth is not none %} {{ '%.1f'|format(d.greatestdepth)
        }} m {% endif %}
      </span>
      <span class="duration">
        {% if d.diveduration is not none %} {% set s = d.diveduration|int %} {%
        set h = s // 3600 %} {% set m = (s % 3600) // 60 %} {% set sec = s % 60
        %} {% if h > 0 %} {{ "%d:%02d:%02d"|format(h, m, sec) }} {% else %} {{
        "%d:%02d"|format(m, sec) }} {% endif %} {% endif %}
      </span>
      <span class="rating">
        {% if d.rating is not none %} {{ d.rating }} {% endif %}
      </span>
      <span class="vis">
        {% if d.visibility is not none %}{{ d.visibility }}{% endif %}
      </span>
    </summary>

    <div class="notes">
      <h3>Notes</h3>
      {% if d.notes %}
      <p>{{ d.notes | e | replace('\n','<br />') | safe }}</p>
      {% else %}
      <p class="muted">No notes.</p>
      {% endif %}
    </div>
  </details>
  {% endfor %}
</div>

<style>
  .dive-accordion {
    display: grid;
    gap: 0.6rem;
  }
  details.dive {
    border: 1px solid var(--border, #e3e3e3);
    border-radius: 10px;
    overflow: clip;
    background: var(--bg, #fff);
  }
  details.dive > summary {
    display: grid;
    grid-template-columns: 50px 110px 90px 72px 65px 60px 1fr;
    gap: 0.75rem;
    align-items: center;
    padding: 0.6rem 0.8rem;
    cursor: pointer;
    list-style: none; /* hide default marker in some browsers */
  }
  details.dive > summary::-webkit-details-marker {
    display: none;
  }
  details.dive[open] > summary {
    border-bottom: 1px solid var(--border, #e3e3e3);
  }
  details.dive .notes {
    padding: 0.75rem 0.9rem 1rem;
  }
  .muted {
    opacity: 0.65;
  }

  /* Make it look table-ish and tidy */
  .num {
    font-weight: 600;
  }
  .rating {
    letter-spacing: 0.08em;
  }

  /* Responsive: collapse to fewer columns on narrow screens */
  @media (max-width: 640px) {
    details.dive > summary {
      grid-template-columns: 60px 1fr 1fr;
      grid-auto-rows: minmax(0, auto);
      row-gap: 0.25rem;
    }
    .depth,
    .duration,
    .rating,
    .vis {
      opacity: 0.9;
      font-size: 0.95em;
    }
  }
</style>
